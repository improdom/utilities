# Define the URL for the Spring Boot log file
$logFileUrl = "http://localhost/actuator/logfile"

# Function to fetch and display the log file content
function Fetch-LogFile {
    try {
        # Get the content of the log file
        $logContent = Invoke-RestMethod -Uri $logFileUrl -ErrorAction Stop
        
        # Clear the console
        Clear-Host
        
        # Display the content with color-coded lines
        foreach ($line in $logContent -split "`n") {
            if ($line -match "error|exception") {
                # Set the font color to yellow for lines containing "error" or "exception"
                Write-Host $line -ForegroundColor Yellow
            } else {
                # Default color for other lines
                Write-Host $line
            }
        }
        
        # Automatically scroll to the bottom by re-outputting the content
        [Console]::SetCursorPosition(0, [Console]::WindowTop + [Console]::WindowHeight - 1)
    } catch {
        Write-Host "Failed to fetch the log file. Error: $_" -ForegroundColor Red
    }
}

# Loop to fetch the log file every 15 seconds
while ($true) {
    Fetch-LogFile
    Start-Sleep -Seconds 15
}
