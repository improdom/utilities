# Define the file path and API endpoint
$filePath = "C:\path\to\your\file.txt"  # Update with your actual file path
$apiUrl = "https://your-api-endpoint.com"  # Replace with your actual API endpoint

# Read the file and iterate through each row
Import-Csv -Path $filePath -Delimiter "`t" | ForEach-Object {
    # Extract the necessary fields
    $eventRuntimeId = $_.event_runtime_id
    $messageBody = $_.message_body

    # Prepare the HTTP POST request
    $response = Invoke-RestMethod -Uri $apiUrl -Method Post -Body $messageBody -ContentType "application/json"

    # Check if the message was sent successfully
    if ($response.StatusCode -eq 200 -or $response.StatusCode -eq $null) {  # Some APIs don't return a StatusCode
        Write-Output "Message with event_runtime_id $eventRuntimeId has been sent successfully."
    } else {
        Write-Output "Failed to send message with event_runtime_id $eventRuntimeId."
    }

    # Delay of 29 minutes before the next message
    Start-Sleep -Minutes 29
}
