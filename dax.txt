from time import sleep
from datetime import datetime

# You can configure how long to run this loop (e.g., 60 minutes = 60 iterations)
duration_minutes = 60

print(f"Starting keep-alive loop at {datetime.now()} for {duration_minutes} minutes...")

for i in range(duration_minutes):
    # Run a simple harmless query that doesn't consume much resources
    result = spark.sql("SELECT current_date()")
    result.show()

    print(f"Keep-alive iteration {i + 1} at {datetime.now()}")
    
    # Wait for 60 seconds
    sleep(60)

print(f"Keep-alive loop ended at {datetime.now()}")
