using System.Text.RegularExpressions;

public class DaxColumnInfo
{
    public string TableName { get; set; }
    public string ColumnName { get; set; }
}

public static DaxColumnInfo ExtractTableAndColumn(string input)
{
    // Case 1: TableName[ColumnName] — must have non-empty table name
    var matchWithTable = Regex.Match(input, @"^(.+?)\[(.+)\]$");
    if (matchWithTable.Success)
    {
        return new DaxColumnInfo
        {
            TableName = matchWithTable.Groups[1].Value.Trim(),
            ColumnName = matchWithTable.Groups[2].Value.Trim()
        };
    }

    // Case 2: [ColumnName] — no table name, treat as measure
    var matchWithoutTable = Regex.Match(input, @"^\[(.+)\]$");
    if (matchWithoutTable.Success)
    {
        return new DaxColumnInfo
        {
            TableName = "arisk_value",
            ColumnName = matchWithoutTable.Groups[1].Value.Trim()
        };
    }

    // Invalid format
    return null;
}
