private static HashSet<string> ExtractMeasures(string dax)
{
    var measures = new HashSet<string>();

    // Match [Measure Name] not preceded by a single quote (i.e., not part of 'Table'[Column])
    var measureRegex = new Regex(@"(?<!')\[\s*([^\[\]]+?)\s*\]", RegexOptions.IgnoreCase);

    foreach (Match match in measureRegex.Matches(dax))
    {
        string measureName = match.Groups[1].Value.Trim();
        measures.Add($"[{measureName}]");
    }

    return measures;
}
