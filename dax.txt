SELECT 
    query_id,
    COUNT(*) AS total_nodes,
    COUNT(*) FILTER (WHERE is_ready = false) AS pending_nodes,
    COUNT(*) FILTER (WHERE is_ready = true) AS ready_nodes
FROM 
    mr_agg_model_refresh.pbi_query_readiness_status
GROUP BY 
    query_id
ORDER BY 
    query_id;
